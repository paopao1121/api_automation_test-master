webpackJsonp([13],{CQrC:function(t,e){},e8JJ:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var a=s("nGEv"),i={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("section",[s("router-link",{staticStyle:{"text-decoration":"none",color:"aliceblue"},attrs:{to:{name:"用例列表",params:{project_id:this.$route.params.project_id}}}},[s("el-button",{staticClass:"return-list"},[s("i",{staticClass:"el-icon-d-arrow-left",staticStyle:{"margin-right":"5px"}}),t._v("用例列表")])],1),t._v(" "),s("el-button",{attrs:{type:"primary"},nativeOn:{click:function(e){return t.addOldApi(e)}}},[s("i",{staticClass:"el-icon-plus",staticStyle:{"margin-right":"5px"}}),t._v("已有接口")]),t._v(" "),s("router-link",{staticStyle:{"text-decoration":"none",color:"#000000"},attrs:{to:{name:"添加新接口"}}},[s("el-button",{attrs:{type:"primary"}},[s("i",{staticClass:"el-icon-plus",staticStyle:{"margin-right":"5px"}}),t._v("新建接口")])],1),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(e){return t.TestAllApi()}}},[s("div",[t._v("测试全部")])]),t._v(" "),s("el-select",{staticStyle:{float:"right"},attrs:{placeholder:"测试环境"},model:{value:t.url,callback:function(e){t.url=e},expression:"url"}},t._l(t.Host,function(t,e){return s("el-option",{key:e+"",attrs:{label:t.name,value:t.id}})}),1),t._v(" "),s("el-dialog",{attrs:{title:"选择创建的API",visible:t.searchApiListVisible,"close-on-click-modal":!1},on:{"update:visible":function(e){t.searchApiListVisible=e}}},[s("el-row",{attrs:{gutter:10}},[s("el-col",{attrs:{span:6}},[s("div",{staticStyle:{height:"400px","line-height":"100px",overflow:"auto","overflow-x":"hidden",border:"1px solid #e6e6e6"}},[s("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"active-text-color":"rgb(32, 160, 255)","unique-opened":!0},on:{select:t.handleSelect}},[s("el-menu-item",{attrs:{index:"-1"},nativeOn:{click:function(e){return t.getApiList()}}},[s("i",{staticClass:"el-icon-menu"}),t._v("所有接口")]),t._v(" "),t._l(t.groupData,function(e,a){return[s("el-menu-item",{key:e.id,staticClass:"group",attrs:{index:a+""},nativeOn:{click:function(s){return t.getApiList(e.id)}}},[s("template",{slot:"title"},[t._v(t._s(e.name)+"\n                                ")])],2)]})],2)],1)]),t._v(" "),s("el-col",{attrs:{span:18}},[s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.apiListLoading,expression:"apiListLoading"}],staticStyle:{width:"100%"},attrs:{data:t.searchApiList,"highlight-current-row":"","show-header":!1,"max-height":"400"},on:{"selection-change":t.selsChange}},[s("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"名称","min-width":"25%",sortable:""}}),t._v(" "),s("el-table-column",{attrs:{prop:"requestType",label:"HTTP方式","min-width":"15%",sortable:""}}),t._v(" "),s("el-table-column",{attrs:{prop:"apiAddress",label:"地址","min-width":"60%",sortable:""}})],1)],1)],1),t._v(" "),s("el-col",{staticClass:"toolbar",attrs:{span:24}},[s("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":20,"page-count":t.total},on:{"current-change":t.handleCurrentChangeApi}})],1),t._v(" "),s("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{nativeOn:{click:function(e){t.searchApiListVisible=!1}}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{type:"primary",loading:t.searchApi},nativeOn:{click:function(e){return t.addOldApiSubmit(e)}}},[t._v("提交")])],1)],1),t._v(" "),s("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.listLoading,expression:"listLoading"}],staticStyle:{width:"100%"},attrs:{data:t.ApiList,"highlight-current-row":""}},[s("el-table-column",{attrs:{type:"index",width:"55"}}),t._v(" "),s("el-table-column",{attrs:{prop:"name",label:"接口名称","min-width":"20%",sortable:"","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-icon",{attrs:{name:"name"}}),t._v(" "),s("router-link",{staticStyle:{"text-decoration":"none",color:"#000000"},attrs:{to:{name:"修改接口",params:{api_id:e.row.id}}}},[t._v(t._s(e.row.name)+"\n                ")])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"address",label:"接口地址","min-width":"50%",sortable:"","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{staticClass:"HttpStatus"},[t._v(t._s(e.row.requestType))]),s("span",{staticStyle:{"font-size":"16px"}},[t._v(t._s(e.row.apiAddress))])]}}])}),t._v(" "),s("el-table-column",{attrs:{prop:"result",label:"测试结果","min-width":"10%",sortable:"","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[s("span",{directives:[{name:"show",rawName:"v-show",value:!e.row.result&&!e.row.testStatus,expression:"!scope.row.result&&!scope.row.testStatus"}]},[t._v("尚无测试结果")]),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.row.testStatus,expression:"scope.row.testStatus"}]},[t._v("测试中...")]),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:"success"===e.row.result&&!e.row.testStatus,expression:"scope.row.result==='success'&&!scope.row.testStatus"}],staticStyle:{color:"#11b95c",cursor:"pointer"},on:{click:function(s){return t.resultShow(e.row)}}},[t._v("成功,查看详情")]),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:"fail"===e.row.result&&!e.row.testStatus,expression:"scope.row.result==='fail'&&!scope.row.testStatus"}],staticStyle:{color:"#cc0000",cursor:"pointer"},on:{click:function(s){return t.resultShow(e.row)}}},[t._v("失败,查看详情")]),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:"timeout"===e.row.result&&!e.row.testStatus,expression:"scope.row.result==='timeout'&&!scope.row.testStatus"}],staticStyle:{color:"#cc0000",cursor:"pointer"},on:{click:function(s){return t.resultShow(e.row)}}},[t._v("请求超时")])]}}])}),t._v(" "),s("el-table-column",{attrs:{label:"操作","min-width":"20%"},scopedSlots:t._u([{key:"default",fn:function(e){return[s("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(s){return t.Test(e.$index,e.row)}}},[t._v("测试")]),t._v(" "),s("router-link",{staticStyle:{"text-decoration":"none",color:"#000000"},attrs:{to:{name:"修改接口",params:{api_id:e.row.id}}}},[s("el-button",{attrs:{size:"small"}},[t._v("修改")])],1),t._v(" "),s("el-button",{attrs:{type:"danger",size:"small"},on:{click:function(s){return t.handleDel(e.$index,e.row)}}},[t._v("删除")])]}}])})],1),t._v(" "),s("el-col",{staticClass:"toolbar",attrs:{span:24}},[s("el-pagination",{staticStyle:{float:"right"},attrs:{layout:"prev, pager, next","page-size":20,"page-count":t.total},on:{"current-change":t.handleCurrentChange}})],1),t._v(" "),s("el-dialog",{attrs:{title:"测试结果",visible:t.TestResult,"close-on-click-modal":!1},on:{"update:visible":function(e){t.TestResult=e}}},[s("div",{staticStyle:{height:"700px",overflow:"auto","overflow-x":"hidden",border:"1px solid #e6e6e6"}},[s("div",{staticClass:"resultStyle",staticStyle:{"font-size":"25px"}},[t._v(t._s(t.result.name))]),t._v(" "),s("div",{staticClass:"lin"}),t._v(" "),s("div",{staticClass:"resultStyle"},[t._v("请求地址:  "+t._s(t.result.url))]),t._v(" "),s("div",{staticClass:"resultStyle"},[t._v("请求方式:  "+t._s(t.result.requestType))]),t._v(" "),s("div",{staticClass:"resultStyle"},[t._v("状态码:  "+t._s(t.result.statusCode))]),t._v(" "),s("div",{staticClass:"resultStyle",staticStyle:{"padding-bottom":"10px"}},[t._v("请求时间:  "+t._s(t.result.testTime))]),t._v(" "),s("div",{staticClass:"lin"}),t._v(" "),s("div",{staticClass:"resultStyle",staticStyle:{"font-size":"25px"}},[t._v("请求头部")]),t._v(" "),t._l(t.result.header,function(e,a){return s("div",{staticClass:"resultStyle"},[t._v(t._s(a)+":  "+t._s(e))])}),t._v(" "),s("div",{staticClass:"lin",staticStyle:{"margin-top":"10px"}}),t._v(" "),s("div",{staticClass:"resultStyle",staticStyle:{"font-size":"25px"}},[t._v("请求参数")]),t._v(" "),s("div",{staticClass:"resultStyle",staticStyle:{"padding-bottom":"10px"}},[t._v(t._s(t.result.parameter))]),t._v(" "),s("div",{staticClass:"lin"}),t._v(" "),s("div",{staticClass:"resultStyle",staticStyle:{"font-size":"25px"}},[t._v("返回结果")]),t._v(" "),s("div",{staticClass:"resultStyle"},[t._v("HTTP状态码:  "+t._s(t.result.statusCode))]),t._v(" "),s("div",{staticClass:"resultStyle"},[t._v("匹配规则:  "+t._s(t.result.examineType))]),t._v(" "),s("div",{staticClass:"resultStyle"},[t._v("规则内容")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.result.data,expression:"result.data"}],staticClass:"resultStyle",staticStyle:{overflow:"auto","overflow-x":"hidden",border:"1px solid #e6e6e6",padding:"10px",width:"90%","word-break":"break-all","line-height":"25px"}},[s("pre",{directives:[{name:"highlightA",rawName:"v-highlightA"}]},[s("code",[t._v(t._s(t.result.data))])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.result.data,expression:"!result.data"}],staticClass:"resultStyle",staticStyle:{overflow:"auto","overflow-x":"hidden",border:"1px solid #e6e6e6",padding:"10px",width:"90%","word-break":"break-all","line-height":"25px","text-align":"center"}},[t._v("无校验规则")]),t._v(" "),s("div",{staticClass:"resultStyle",staticStyle:{"font-size":"25px"}},[t._v("实际结果")]),t._v(" "),s("div",{staticClass:"resultStyle"},[t._v("HTTP状态码:  "+t._s(t.result.httpStatus))]),t._v(" "),s("div",{staticClass:"resultStyle"},[t._v("实际返回内容")]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:t.result.responseData,expression:"result.responseData"}],staticClass:"resultStyle",staticStyle:{overflow:"auto","overflow-x":"hidden",border:"1px solid #e6e6e6",padding:"10px",width:"90%","word-break":"break-all","line-height":"25px"}},[s("pre",{directives:[{name:"highlightA",rawName:"v-highlightA"}]},[s("code",[t._v(t._s(t.result.responseData))])])]),t._v(" "),s("div",{directives:[{name:"show",rawName:"v-show",value:!t.result.responseData,expression:"!result.responseData"}],staticClass:"resultStyle",staticStyle:{overflow:"auto","overflow-x":"hidden",border:"1px solid #e6e6e6",padding:"10px",width:"90%","word-break":"break-all","line-height":"25px","text-align":"center"}},[t._v("无返回内容")])],2)])],1)},staticRenderFns:[]};var r=function(t){s("CQrC")},o=s("VU/8")(a.a,i,!1,r,"data-v-50a5f720",null);e.default=o.exports},nGEv:function(module,__webpack_exports__,__webpack_require__){"use strict";var __WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__=__webpack_require__("mvHQ"),__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify__),__WEBPACK_IMPORTED_MODULE_1__api_api__=__webpack_require__("P9l9"),__WEBPACK_IMPORTED_MODULE_2_jquery__=__webpack_require__("7t+N"),__WEBPACK_IMPORTED_MODULE_2_jquery___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_2_jquery__),__WEBPACK_IMPORTED_MODULE_3_moment__=__webpack_require__("PJh5"),__WEBPACK_IMPORTED_MODULE_3_moment___default=__webpack_require__.n(__WEBPACK_IMPORTED_MODULE_3_moment__);__webpack_exports__.a={data:function(){return{project:"",case:"",ApiList:[],listLoading:!1,searchName:"",total:0,url:"",Host:[],searchApiListVisible:!1,searchApi:!1,searchApiList:[],groupData:[],apiListLoading:!1,apiTotal:0,pageApi:1,sels:[],TestResult:!1,result:{},ApiListLen:"",ApiListIndex:0,activeIndex:""}},methods:{handleSelect:function(t,e){this.activeIndex=t,console.log(this.activeIndex)},getCaseApiList:function(){this.listLoading=!0;var t=this;__WEBPACK_IMPORTED_MODULE_2_jquery___default.a.ajax({type:"get",url:__WEBPACK_IMPORTED_MODULE_1__api_api__.z+"/api/automation/api_list",async:!0,data:{project_id:this.$route.params.project_id,page:t.page,name:t.searchName,case_id:this.$route.params.case_id},headers:{Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){t.listLoading=!1,"999999"===e.code?(t.ApiList=[],t.total=e.data.total,e.data.data.forEach(function(e){e.result=!1,t.ApiList.push(e)})):t.$message.error({message:e.msg,center:!0})}})},Test:function(t,e){if(this.url){e.testStatus=!0;var s=this;__WEBPACK_IMPORTED_MODULE_2_jquery___default.a.ajax({type:"post",url:__WEBPACK_IMPORTED_MODULE_1__api_api__.z+"/api/automation/start_test",async:!0,data:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()({project_id:Number(this.$route.params.project_id),case_id:Number(this.$route.params.case_id),host_id:Number(this.url),id:Number(e.id)}),headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},success:function(t){"999999"===t.code?e.result=t.data.result:s.$message.error({message:t.msg,center:!0}),e.testStatus=!1},error:function(){e.testStatus=!1}})}else this.$message({message:"请选择测试环境",center:!0,type:"warning"})},ApiTotal:function(){this.ApiListLen=this.ApiList.length},TestAllApi:function(){for(var t=0;t<this.ApiList.length;t++)this.ApiList[t].result="";this.TestAll()},TestAll:function(){if(this.url){var t=this;this.ApiList[this.ApiListIndex].testStatus=!0,__WEBPACK_IMPORTED_MODULE_2_jquery___default.a.ajax({type:"post",url:__WEBPACK_IMPORTED_MODULE_1__api_api__.z+"/api/automation/start_test",async:!0,data:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()({project_id:Number(this.$route.params.project_id),case_id:Number(this.$route.params.case_id),host_id:Number(this.url),id:Number(this.ApiList[this.ApiListIndex].id)}),headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},success:function(e){"999999"===e.code?(t.ApiList[t.ApiListIndex].testStatus=!1,t.ApiList[t.ApiListIndex].result=e.data.result,t.ApiListIndex=t.ApiListIndex+1,t.ApiListIndex!==t.ApiList.length?t.TestAll():t.ApiListIndex=0):(t.ApiList[t.ApiListIndex].testStatus=!1,t.ApiListIndex=0,t.$message.error({message:e.msg,center:!0}))}})}else this.$message({message:"请选择测试环境",center:!0,type:"warning"})},handleDel:function(t,e){var s=this;this.$confirm("确认删除该记录吗?","提示",{type:"warning"}).then(function(){s.listLoading=!0;var t=s;__WEBPACK_IMPORTED_MODULE_2_jquery___default.a.ajax({type:"post",url:__WEBPACK_IMPORTED_MODULE_1__api_api__.z+"/api/automation/del_api",async:!0,data:__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()({project_id:Number(s.$route.params.project_id),case_id:Number(s.$route.params.case_id),ids:[e.id]}),headers:{"Content-Type":"application/json",Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){"999999"===e.code?t.$message({message:"删除成功",center:!0,type:"success"}):t.$message.error({message:e.msg,center:!0}),t.getCaseApiList()}})}).catch(function(){})},getApiGroup:function(){var t=this;__WEBPACK_IMPORTED_MODULE_2_jquery___default.a.ajax({type:"get",url:__WEBPACK_IMPORTED_MODULE_1__api_api__.z+"/api/api/group",async:!0,data:{project_id:this.$route.params.project_id},headers:{Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){"999999"===e.code?t.groupData=e.data:t.$message.error({message:e.msg,center:!0})}})},getApiList:function(t){this.apiListLoading=!0;var e=this,s={project_id:Number(this.$route.params.project_id),page:e.page};t&&(s.apiGroupLevelFirst_id=Number(t)),__WEBPACK_IMPORTED_MODULE_2_jquery___default.a.ajax({type:"get",url:__WEBPACK_IMPORTED_MODULE_1__api_api__.z+"/api/api/api_list",async:!0,data:s,headers:{Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(t){e.apiListLoading=!1,"999999"===t.code?(e.searchApiList=t.data.data,e.total=t.data.total):e.$message.error({message:t.msg,center:!0})}})},resultShow:function(t){this.result.name=t.name,this.getResult(t.id)},getResult:function getResult(_id){var self=this;__WEBPACK_IMPORTED_MODULE_2_jquery___default.a.ajax({type:"get",url:__WEBPACK_IMPORTED_MODULE_1__api_api__.z+"/api/automation/look_result",async:!0,data:{project_id:this.$route.params.project_id,case_id:this.$route.params.case_id,api_id:_id},headers:{Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function success(data){"999999"===data.code?(self.result.url=data.data.url,self.result.requestType=data.data.requestType,self.result.header=eval("("+data.data.header+")"),self.result.parameter=data.data.parameter,self.result.statusCode=data.data.statusCode,self.result.examineType=data.data.examineType,self.result.data=data.data.data,self.result.result=data.data.result,self.result.httpStatus=data.data.httpStatus,self.result.responseData=JSON.parse(data.data.responseData.replace(/'/g,'"').replace(/None/g,"null").replace(/True/g,"true").replace(/False/g,"false")),self.result.testTime=data.data.testTime,self.TestResult=!0):self.$message.error({message:data.msg,center:!0})},error:function(){self.$message.error({message:"失败",center:!0})}})},addOldApi:function(){this.searchApiListVisible=!0,this.getApiGroup(),this.getApiList()},addOldApiSubmit:function(){var t=this,e=this.sels.map(function(t){return t.id}),s=this;this.$confirm("确认添加选中记录吗？","提示",{type:"warning"}).then(function(){var a=__WEBPACK_IMPORTED_MODULE_0_babel_runtime_core_js_json_stringify___default()({project_id:Number(t.$route.params.project_id),case_id:Number(t.$route.params.case_id),api_ids:e});__WEBPACK_IMPORTED_MODULE_2_jquery___default.a.ajax({type:"post",url:__WEBPACK_IMPORTED_MODULE_1__api_api__.z+"/api/automation/add_old_api",async:!0,data:a,headers:{Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(t){s.searchApiListVisible=!1,"999999"===t.code?s.$message({message:"添加成功",center:!0,type:"success"}):s.$message.error({message:t.msg,center:!0}),s.getCaseApiList()}})}).catch(function(){})},handleCurrentChange:function(t){this.page=t,this.getCaseApiList()},handleCurrentChangeApi:function(t){console.log(this.groupData[this.activeIndex].id),this.page=t,this.getApiList(this.groupData[this.activeIndex].id)},selsChange:function(t){this.sels=t},getHost:function(){var t=this;__WEBPACK_IMPORTED_MODULE_2_jquery___default.a.ajax({type:"get",url:__WEBPACK_IMPORTED_MODULE_1__api_api__.z+"/api/global/host_total",async:!0,data:{project_id:this.$route.params.project_id},headers:{Authorization:"Token "+JSON.parse(sessionStorage.getItem("token"))},timeout:5e3,success:function(e){"999999"===e.code?e.data.data.forEach(function(e){e.status&&t.Host.push(e)}):t.$message.error({message:e.msg,center:!0})}})}},mounted:function(){this.getCaseApiList(),this.getHost(),this.project=this.$route.params.project_id,this.case=this.$route.params.case_id}}}});
//# sourceMappingURL=13.e0153b6e7bb2a5a36d9e.js.map